{% extends "base.html" %}

{% block title %}Configuración del Negocio - Veterinaria{% endblock %}

{% block content %}
<div class="bg-gradient-to-r from-indigo-600 to-indigo-800 text-white rounded-lg shadow-lg mb-6 p-6">
    <div class="flex items-center">
        <i class="fas fa-cog text-4xl mr-4"></i>
        <div>
            <h2 class="text-3xl font-bold">Configuración del Negocio</h2>
            <p class="text-indigo-100 mt-1">Gestiona la información y logo de tu negocio</p>
        </div>
    </div>
</div>

<div class="bg-white shadow-lg rounded-lg max-w-4xl mx-auto">
    <form method="POST" action="{{ url_for('admin.configuracion_negocio') }}" enctype="multipart/form-data" class="p-8">
        <!-- Información Básica -->
        <div class="mb-8">
            <div class="flex items-center mb-6 pb-4 border-b-2 border-indigo-200">
                <div class="bg-indigo-100 rounded-full p-3 mr-3">
                    <i class="fas fa-info-circle text-indigo-600 text-xl"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800">Información del Negocio</h3>
            </div>

            <div class="space-y-6">
                <!-- Nombre del Negocio -->
                <div>
                    <label for="nombre_negocio" class="block text-lg font-bold text-gray-700 mb-2">
                        <i class="fas fa-store mr-2 text-indigo-600"></i>Nombre del Negocio *
                    </label>
                    <input type="text" 
                           id="nombre_negocio" 
                           name="nombre_negocio" 
                           value="{{ config.nombre_negocio or '' }}"
                           required
                           class="w-full px-5 py-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-4 focus:ring-indigo-500 focus:border-indigo-500 transition-all"
                           placeholder="Ej: Veterinaria San Roque">
                    <p class="mt-2 text-sm text-gray-500">
                        <i class="fas fa-info-circle mr-1"></i>Este nombre aparecerá en facturas y documentos
                    </p>
                </div>

                <!-- NIT -->
                <div>
                    <label for="nit" class="block text-lg font-bold text-gray-700 mb-2">
                        <i class="fas fa-id-card mr-2 text-indigo-600"></i>NIT
                    </label>
                    <input type="text" 
                           id="nit" 
                           name="nit" 
                           value="{{ config.nit or '' }}"
                           class="w-full px-5 py-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-4 focus:ring-indigo-500 focus:border-indigo-500 transition-all"
                           placeholder="Ej: 123456789-1">
                    <p class="mt-2 text-sm text-gray-500">
                        <i class="fas fa-info-circle mr-1"></i>Número de identificación tributaria (opcional)
                    </p>
                </div>

                <!-- Dirección -->
                <div>
                    <label for="direccion" class="block text-lg font-bold text-gray-700 mb-2">
                        <i class="fas fa-map-marker-alt mr-2 text-indigo-600"></i>Dirección
                    </label>
                    <textarea id="direccion" 
                              name="direccion" 
                              rows="3"
                              class="w-full px-5 py-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-4 focus:ring-indigo-500 focus:border-indigo-500 transition-all"
                              placeholder="Dirección completa del negocio">{{ config.direccion or '' }}</textarea>
                    <p class="mt-2 text-sm text-gray-500">
                        <i class="fas fa-info-circle mr-1"></i>Dirección completa del establecimiento (opcional)
                    </p>
                </div>

                <!-- Teléfono -->
                <div>
                    <label for="telefono" class="block text-lg font-bold text-gray-700 mb-2">
                        <i class="fas fa-phone mr-2 text-indigo-600"></i>Teléfono
                    </label>
                    <input type="text" 
                           id="telefono" 
                           name="telefono" 
                           value="{{ config.telefono or '' }}"
                           class="w-full px-5 py-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-4 focus:ring-indigo-500 focus:border-indigo-500 transition-all"
                           placeholder="Ej: 3001234567">
                    <p class="mt-2 text-sm text-gray-500">
                        <i class="fas fa-info-circle mr-1"></i>Número de teléfono de contacto (opcional)
                    </p>
                </div>

                <!-- Correo -->
                <div>
                    <label for="correo" class="block text-lg font-bold text-gray-700 mb-2">
                        <i class="fas fa-envelope mr-2 text-indigo-600"></i>Correo Electrónico
                    </label>
                    <input type="email" 
                           id="correo" 
                           name="correo" 
                           value="{{ config.correo or '' }}"
                           class="w-full px-5 py-4 text-lg border-2 border-gray-300 rounded-lg focus:ring-4 focus:ring-indigo-500 focus:border-indigo-500 transition-all"
                           placeholder="Ej: contacto@veterinaria.com">
                    <p class="mt-2 text-sm text-gray-500">
                        <i class="fas fa-info-circle mr-1"></i>Correo electrónico de contacto (opcional)
                    </p>
                </div>
            </div>
        </div>

        <!-- Logo del Negocio -->
        <div class="mb-8 border-t-2 pt-8">
            <div class="flex items-center mb-6 pb-4 border-b-2 border-purple-200">
                <div class="bg-purple-100 rounded-full p-3 mr-3">
                    <i class="fas fa-image text-purple-600 text-xl"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-800">Logo del Negocio</h3>
            </div>

            <div class="space-y-6">
                <!-- Logo actual -->
                {% if config.logo_path %}
                <div>
                    <label class="block text-lg font-bold text-gray-700 mb-3">
                        <i class="fas fa-image mr-2 text-purple-600"></i>Logo Actual
                    </label>
                    <div class="bg-gray-50 p-6 rounded-lg border-2 border-gray-200">
                        <img src="{{ url_for('static', filename=config.logo_path) }}" 
                             alt="Logo actual" 
                             class="max-h-32 mx-auto"
                             onerror="this.style.display='none'">
                    </div>
                </div>
                {% endif %}

                <!-- Cargar nuevo logo -->
                <div>
                    <label for="logo" class="block text-lg font-bold text-gray-700 mb-2">
                        <i class="fas fa-upload mr-2 text-purple-600"></i>{% if config.logo_path %}Reemplazar Logo{% else %}Cargar Logo{% endif %}
                    </label>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-purple-400 transition-colors">
                        <input type="file" 
                               id="logo" 
                               name="logo" 
                               accept=".png,image/png"
                               class="hidden"
                               onchange="mostrarVistaPrevia(event)">
                        <label for="logo" class="cursor-pointer">
                            <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-3 block"></i>
                            <p class="text-gray-600 font-semibold mb-1">Haz clic para seleccionar un archivo PNG</p>
                            <p class="text-sm text-gray-500">Solo se aceptan archivos PNG</p>
                        </label>
                    </div>
                    <div id="vista-previa" class="mt-4 hidden">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Vista Previa:</label>
                        <div class="bg-gray-50 p-4 rounded-lg border-2 border-gray-200">
                            <img id="preview-img" src="" alt="Vista previa" class="max-h-32 mx-auto">
                        </div>
                    </div>
                    <p class="mt-2 text-sm text-gray-500">
                        <i class="fas fa-info-circle mr-1"></i>El logo debe ser un archivo PNG. Se recomienda una imagen cuadrada o rectangular
                    </p>
                </div>
            </div>
        </div>

        <!-- Botones de acción -->
        <div class="flex justify-end gap-4 pt-6 border-t-2 border-gray-200">
            <a href="{{ url_for('admin.dashboard') }}" 
               class="px-8 py-4 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors font-bold text-lg">
                <i class="fas fa-times mr-2"></i>Cancelar
            </a>
            <button type="submit" 
                    class="px-8 py-4 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-bold text-lg shadow-lg">
                <i class="fas fa-save mr-2"></i>Guardar Configuración
            </button>
        </div>
    </form>
</div>

<script>
function mostrarVistaPrevia(event) {
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            const previewDiv = document.getElementById('vista-previa');
            const previewImg = document.getElementById('preview-img');
            previewImg.src = e.target.result;
            previewDiv.classList.remove('hidden');
        };
        reader.readAsDataURL(file);
    }
}
</script>
{% endblock %}

